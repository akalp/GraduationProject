{% extends 'base.html' %}
{% load static font_awesome %}
{% block title %} Orders {% endblock %}
{% block style %}
    <link rel="stylesheet" href="{% static 'sidebar.css' %}">
    <style>
        .dappalphabet {
            position: fixed;
            left: 0;
            width: 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-around;
            height: 100%;
            top: 0;
            padding-top: 64px;
        }

        .spacebetween {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
        }

        .dapplistlogo {
            border-radius: 3px;
            height: 32px;
            width: 32px;
            margin-right: 5px;
        }

        .assetscontentitem {
            width: 160px;
            padding: 8px;
        }

        .assetcontenimgdiv {
            width: 100%;
            height: 0;
            padding-bottom: 100%;
            overflow: hidden;
            position: relative;
        }

        .assetcontenimg {
            width: 100%;
            position: absolute;
            height: 100%;
            border-radius: 4px;
        }

        .assetimg {
            object-fit: contain;
        }

        .cover {
            width: 100%;
            border-radius: 3px;
            -webkit-animation: coverimg .8s ease-in-out;
        }

        .order-table {
            overflow-y: auto;
            height: calc(100vh - 64px);
        }

        .loader {
            border: 16px solid #f3f3f3; /* Light grey */
            border-top: 16px solid #3498db; /* Blue */
            border-radius: 50%;
            width: 120px;
            height: 120px;
            animation: spin 2s linear infinite;
            margin: auto;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
    </style>
{% endblock %}
{% block content %}
    <div class="container-fluid">
        <div class="row">
            <nav class="col-md-2 d-none d-md-block bg-light sidebar">
                <div class="sidebar-sticky">
                    <div class="dappalphabet">
                        <div class="alphabet">A</div>
                        <div class="alphabet">B</div>
                        <div class="alphabet">C</div>
                        <div class="alphabet">D</div>
                        <div class="alphabet">E</div>
                        <div class="alphabet">F</div>
                        <div class="alphabet">G</div>
                        <div class="alphabet">H</div>
                        <div class="alphabet">I</div>
                        <div class="alphabet">J</div>
                        <div class="alphabet">K</div>
                        <div class="alphabet">L</div>
                        <div class="alphabet">M</div>
                        <div class="alphabet">N</div>
                        <div class="alphabet">O</div>
                        <div class="alphabet">P</div>
                        <div class="alphabet">Q</div>
                        <div class="alphabet">R</div>
                        <div class="alphabet">S</div>
                        <div class="alphabet">T</div>
                        <div class="alphabet">U</div>
                        <div class="alphabet">V</div>
                        <div class="alphabet">W</div>
                        <div class="alphabet">X</div>
                        <div class="alphabet">Y</div>
                        <div class="alphabet">Z</div>
                    </div>
                    <ul>
                        <li class="spacebetween" style="color: rgb(191, 191, 191); margin-bottom: 1rem;">
                            <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                                <span>Games</span>
                            </h6>
                        </li>
                        {% for game in games %}
                            <li class="spacebetween" style="color: rgb(191, 191, 191); margin-bottom: 1rem;">
                                <a href="{% url 'dex:list_order' game=game.pk %}">
                                    <div style="display: flex; align-items: center; width: 100%;">
                                        <img class="dapplistlogo" src="{{ game.img.url }}">
                                        <div>{{ game.name }}</div>
                                    </div>
                                </a>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            </nav>
            <div class="col-md-9 ml-sm-auto col-lg-10 px-4">
                <div class="row">
                    <div class="col-6 order-table border-right">
                        <div class="text-center">
                            <h1>Sell&nbsp;
                                <button class="btn btn-sm btn-success mb-2 order-button"
                                        data-url="{% url 'dex:add_sell' %}" data-target="#modal">
                                    {% fa 'fa-plus' %}&nbsp;Satış Emri Ekle
                                </button>
                            </h1>
                        </div>
                        <div class="row justify-content-center">
                            {% for order in sell_orders %}
                                <a href="{% url 'dex:detail_sell' pk=order.pk %}">
                                    <div class="assetscontentitem border col-md-2 m-2">
                                        <div style="width: 100%;">
                                            <div class="assetcontenimgdiv">
                                                <div class="assetcontenimg">
                                                    <div style="width: 100%; height: 100%; position: relative;">
                                                        <img class="assetimg cover"
                                                             src="{{ order.obj.img.url }}"
                                                             alt=" ">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="assetname text-center">{{ order.obj.name }}
                                                <a href="{% url 'dex:delete_sell' pk=order.pk %}">sil</a>
                                            </div>
                                            <div class="assetvaluediv">
                                                <div class="assetvalue text-center">{{ order.value }}&nbsp;ETH</div>
                                            </div>
                                        </div>
                                    </div>
                                </a>

                            {% endfor %}
                        </div>
                    </div>
                    <div class="col-6 order-table border-right">
                        <div class="text-center">
                            <h1>Buy&nbsp;
                                <button class="btn btn-sm btn-success mb-2 order-button"
                                        data-url="{% url 'dex:add_buy' %}" data-target="#modal">
                                    {% fa 'fa-plus' %}&nbsp;Alış Emri Ekle
                                </button>
                            </h1>
                        </div>
                        <div class="row justify-content-center">
                            {% for order in buy_orders %}
                                <a href="{% url 'dex:detail_buy' pk=order.pk %}">
                                    <div class="assetscontentitem border col-md-2 m-2">
                                        <div style="width: 100%;">
                                            <div class="assetcontenimgdiv">
                                                <div class="assetcontenimg">
                                                    <div style="width: 100%; height: 100%; position: relative;">
                                                        <img class="assetimg cover"
                                                             src="{{ order.obj.img.url }}"
                                                             alt=" ">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="assetname text-center">{{ order.obj.name }}
                                                <a href="{% url 'dex:delete_buy' pk=order.pk %}">sil</a>
                                            </div>
                                            <div class="assetvaluediv">
                                                <div class="assetvalue text-center">{{ order.value }}&nbsp;ETH</div>
                                            </div>
                                        </div>
                                    </div>
                                </a>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
{% block script %}
    <script>
        let loading = '<div class="modal-dialog modal-dialog-centered"><div class="modal-content"><div class="modal-body"><div class="loader"></div></div></div></div>';
        $('.order-button').on('click', function () {
            $.ajax({
                beforeSend: function(){
                    $('#modal').html(loading);
                    $('#modal').modal('show');
                },
                url: $(this).attr('data-url'),
                success: function (result) {
                    $('#modal').html(result);
                }
            })
        });
    </script>

{% endblock %}